# Cross configuration for cross-platform builds
[build]
# Build build-scripts in the container to avoid GLIBC version issues
xargo = false

[build.env]
passthrough = ["RUST_BACKTRACE"]

[target.aarch64-unknown-linux-gnu]
# Install Python for PyO3 build
# Install both native (for build scripts) and cross-arch Python (for linking)
pre-build = [
    "dpkg --add-architecture arm64",
    "apt-get update",
    "apt-get install -y python3 python3-dev libpython3-dev:arm64"
]

[target.aarch64-unknown-linux-gnu.env]
passthrough = [
    "PYO3_CROSS",
    "PYO3_CROSS_LIB_DIR",
    "PYO3_CROSS_PYTHON_VERSION"
]
# Set Python environment for cross-compilation
PYO3_CROSS_LIB_DIR = "/usr/lib/aarch64-linux-gnu"

[target.aarch64-linux-android]
# Install Python for PyO3 build
pre-build = [
    "apt-get update",
    "apt-get install -y python3 python3-dev"
]
